---
title: "应用层"
date: 2023-04-21T17:28:36+08:00
draft: true
---

# 作用
    解决应用进程的交互来实现特定网络应用问题。

    域名通过域名系统DNS转化为IP地址


## 客户/服务器方式（C/S）和对等方式（P2P）

### 客户/服务器（Client/Server， C/S）
    客户和服务器是指通信中所涉及的两个应用进程。
    
    客户/服务器方式所描述的是进程之间服务和被服务的关系。

    C/S方式是因特网上传统的，同时也是最成熟的方式，很多我们熟悉的网络应用都是采用C/S方式。包括万维网www，电子邮件，文件传输FTP等

    基于C/S方式等应用服务通常是服务集中型等，即应用服务集中在网络中比客户计算机少得多的服务计算机上。

    由于一台服务计算机要为多个客户机提供服务，在C/S应用中，常会出现服务器计算机跟不上众多客户机请求等情况。

    为此，在C/S应用中，常用计算机集群（或服务器场）构建一个强大的虚拟服务器。


### 对等（Peer-to-Peer， P2P）方式
    在P2P方式中，没有固定的服务请求者和服务提供者，分布在网络边缘各端系统中的应用进程是对等的，被称为对等方。对等方之间互相通信，每个对等方即是服务的请求着，又是服务的提供者。

    目前，在因特网上流行的P2P应用主要包括P2P文件共享，即时通讯，P2P流媒体，分布式存储等。

    基于P2P的应用是服务分散型对等，因为服务不是集中在少数几个服务器中，而是分散在大量对等计算机中，这些计算机并不为服务·提供商所有，而是为个人控制的桌面计算机和笔记本电脑，他们通常位于住宅，校园和办公室中。

    P2P方式的最突出特性之一就是它的可扩展性。因为系统每增加一个对等方，不仅增加的是服务的请求者，同时也是服务的提供者，系统性能不会因为规模的增大而降低。

    P2P方式具有成本上的优势，因为它通常不需要庞大的服务器设施和服务器带宽。位降低成本，服务提供商对于P2P方式用于应用的兴趣越来越大。


## 动态主机配置协议DHCP


### DHCP过程
    

### DHCP主要使用以下报文来实现其功能
    DHCP DISCOVER：DHCP发现报文

    DHCP OFFER：DHCP提供报文

    DHCP REQUSEST：DHCP请求报文

    DHCP ACK：DHCP确认报文

    DHCP NACK：DHCP否认报文

    DHCP RELESE：DHCP释放报文

### DHCP报文在运输层使用UDP协议封装
    DHCP客户使用的UDP端口号位68

    DHCP服务器使用的UDP端口号为67

    DHCP客户在为获取到IP地址时使用的地址0.0.0.0

    在每一个网络上都设置一个DHCP服务器会使DHCP服务器数量太多。因此现在上使每一个网络至少有一个DHCP中继代理（通常是一台路由器），它配置了DHCP服务器的IP地址信息，作为各网络中计算机与DHCP服务器的桥梁


## 域名系统DNS（Domain Name System）

### DNS的作用


### 域名分类
    国家顶级域名： cn（中国），us（美国），uk（英国）

    通用顶级域名：com（公司企业），net（网络服务机构），org（非营利性组织），int（国际组织），edu（美国教育机构），gov（美国政府部门）等。

    反向域：用于反向域，即IP地址反向解析为域名。

    在国家顶级域名下注册等二级域名均由该国家自行决定。

    我国的二级域名有以下两类：

        1. 类别域名：ac（科研机构），com（工，商，金融等企业），edu（教育机构），gov（政府部门），net（提供网络服务等机构），mil（军事机构），org（非盈利性组织）。
        
        2. 行政域名：适用于各省，自治区，直辖市。例如bj为北京市，sh为上海市等。



## 域名服务器的类型

### 根域名服务器
    根域名服务器是最高层次的服务器，每个根域名服务器都知道所有顶级域名服务器的域名及其IP地址。因特网上共有13个不同IP地址的根域名服务器。尽管将13个域名服务器中的每一个都视为单个服务器，但“每台服务器”实际上是有许多分布在世界各地的计算机构成的服务器群集。当本地域名服务器向根域名服务器发出查询请求时，路由器就把查询报文转发到离这个DNS客户最近的一个根域名服务器。这就加快了域名解析的过程，同时也更合理的利用了因特网资源。根域名服务器不直接对域名进行解析而是返回该域名所属顶级域名的顶级域名服务器的IP地址。

### 顶级域名服务器：
    这些域名服务器负责管理在该顶级域名服务器注册的所有二级域名。当收到DNS查询请求时就给出相应的回答（可能是结果，也可能是下一级权限域名服务器的IP地址）。

### 权限域名服务器：
    这些域名服务器负责某个区的域名，每一个主机的域名都必须在某个权限域名域名服务器处注册登记。因此权限域名服务器知道其管辖的域名雨IP地址的映射关系。另外，权限域名服务器还知道其下级域名服务器的地址。

 ### 本地域名服务器：
    本地域名服务器不属于上述的域名服务器的等级结构。当一个主机发出DNS请求时，这个报文就首先被送往该主机的本地域名服务器。本地域名服务器起着代理作用，回将该报文转发到上述的域名服务器的顶级结构中。每一个因特网服务提供者ISP，一个大学，甚至一个大学的学院，都可以拥有一个本地域名服务器，它有时被称为默认域名服务器。本地域名服务器离用户较近，一般不超过几个路由器的距离，也有可能在同一个局域网中。本地域名服务器的IP地址需要直接配置在需要域名解析的主机中。

## 文件传送协议FTP（File Transfer Protocol）

    FTP提供交互式的访问，允许客户指明文件类型与格式（如，是否使用ASCII码），并允许文件具有存取权限（如访问文件的用户必须结果授权，并输入有效口令）。
    
    FTP屏蔽了各计算机系统的细节，因而适合于在异构网络中任意计算机之间传送文件。

    默认情况下，FTP使用TCP 21端口进行控制连接，TCP 20端口进行数据连接。但是，是否使用TCP 20端口建立数据连接雨传输模式有关，主动方式使用TCP 20端口，被动方式由服务器和客户端自行协商决定。


## 电子邮件

### 电子邮件采用客户/服务器方式

    电子邮件的三个组成构件：用户代理，邮件服务器，以及电子邮件所需的协议。

    用户代理是用户雨电子邮件系统的接口，又称为电子邮件客户端软件。

    邮件服务器是电子邮件系统的基础设施。因特网上所有的ISP都有邮件服务器，其功能是发送和接收邮件，同时还要负责维护用户的邮箱。

    协议包括邮件发送协议（例如SMTP）和邮件读取协议（例如POP3，IMAP）。

### 简单邮件传送协议SMTP（Simple Mail Transfer Protocol）的基本工作原理

    SMTP协议只能传送ASCII码文本数据，不可传送可执行文件或其它的二进制对象。

    SMTP不能满足传送多媒体邮件（例如带有图片，音频或视频数据）的需要。并且许多其它非英语国家的文字（例如中文，俄文）也无法使用SMTP传送。

    为解决SMTP传送非ASCII码文本的问题，提出了多用途因特网扩展MIME（Multipurpose Internet Mail Extensions）。
        
        1. 增加了5个新的邮件首部字段，这些字段提供了有关邮件主体的信息。
        
        2. 定义了许多邮件内容格式，对多媒体电子邮件的表示方法进行了标准化。
        
        3. 定义了传送编码，可对任何内容格式进行转化，而不会被邮件系统改变。 
    
    实际上，MIME不仅仅用于SMTP，也用于后来的同样面向ASCII字符的HTTP。


### 邮件读取协议

    邮局协议POP（Post Office Protocol），POP3是第三个版本，是因特网正式标志。非常简单，功能有限的邮件读取协议。用户只能一下载并删除方式或下载并保留方式从邮件服务器下载邮件到以后计算机。不允许用户在邮件服务器上管理自己的邮件（如创建文件夹，分类等）。

    因特网邮件访问协议IMAP（Internet Message Access Protocol），IMAP4是第四个版本，目前还只有因特网建议标志。功能比POP3强大的邮件读取协议。用户在自己的计算机上就可以操控邮件服务器中的邮箱，就像在本地操控一样，因此IMAP是一个联机协议。

    POP3和IMAP4都采用基于TCP连接客户端/服务器方式。POP3使用端口110，IMAP4使用端口143。


## 万维网
    万维网WWW（World Wide Web）并非某种特殊的计算机网络。它是一个大规模的，联机式的信息储藏所，是运行在因特网上的一个分布式应用。

    万维网利用网页之间的超链接将不同的网站的网页链接成一张逻辑上的信息网。 

### HTTP/1.0
    HTTP/1.0采用非持续链接方式。在该方式下，每次浏览器要请求一个文件都要与服务器建立TCP连接，当收到响应后就立即关闭连接。

        1. 每请求一个文档就要有两倍多RTT开销。若一个网页上有很多引用对象（例如图片等），那么请求每一个对象都需要花费2RTT的时间。
        
        2. 为了减小时延，浏览器通常会建立多个并行的TCP连接同时请求多个对象。但是，这会大量占用万维网服务器的资源，特别是万维网服务器要同时服务大量的客户请求，这会是其负担很重。
   

### HTTP/1.1

    1. HTTP/1.1采用持续链接方式。在该方式下，万维网服务器在发送响应后仍然保持这条连接，使同一个客户和服务器可以继续在这条连接上传送后续的HTTP请求报文和响应报文。这并不局限于传送同一个页面上的引用对象，而是只有这些文档都在同一个服务器上就行。

    2. 为进一步提高效率，HTTP/1.1的持续连接还可以使用流水线方式工作，即浏览器在收到HTTP的响应报文之前就能够连续发送多个报文。这样一个接一个的请求报文到达服务器后，服务器就发回一个接一个的响应报文。这样就节省了很多个RTT时间，使TCP连接中的空闲时间减少，提高了下载文档的效率。

### HTTP报文格式
    HTTP是面向文本的，其报文的每一个字段都是一些ASCII码串，并且🇺🇸字段的长度都是不确定的。


### HTTP请求报文格式
    方法||URL||版本CRLF             ||表示空格  CRLF表示回车换行
    首部字段名：||值 CRLF
    首部字段名：||值 CRLF
    ...
    首部字段名：||值 CRLF
    CRLF
    使用主体（通常不用）


### HTTP响应报文格式
    版本||状态码||短语CRLF             ||表示空格  CRLF表示回车换行
    首部字段名：||值 CRLF
    首部字段名：||值 CRLF
    ...
    首部字段名：||值 CRLF
    CRLF
    使用主体（通常不用）

### 常用方法
|      |     |   
|:---------:|:---------:|   
|方法       | 描述  |
|GET|请求URL标志的文档|
|HEAD|请求URL标志的文档首部|
|POST|向服务器发送数据|
|PUT|在指明的URL下储存下一个文档|
|DELETE|删除URL标志的文档|
|CONNECT|用于代理服务器|
|OPTIONS|请求一些选项信息|
|TRACE|用来进行环回厕所|
|PATCH|对PUT方法分补充，用来对已知资源进行局部更新|

    持续连接方式：服务器在发送响应后仍然保持这条连接，使同一客户（浏览器）和该服务器可以继续在这条连接上传后续的HTTP请求报文和响应报文。

    非流水线方式：只有收到上一个请求的响应，才能发送下一个请求。

